/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import _0x19397c from'../ckeditorcloudserviceserror.js';class WebSocketRequest{constructor(_0x1f6c03,_0x1a33ee){this['_context']=_0x1f6c03,this['_deferredPromise']=(function(){let _0x1aaa13,_0x46b2c4;const _0x51962f=new Promise((_0x2a9f98,_0x507d89)=>{_0x1aaa13=_0x2a9f98,_0x46b2c4=_0x507d89;});return{'resolve':_0x1aaa13,'reject':_0x46b2c4,'promise':_0x51962f};}()),this['timeout']=setTimeout(()=>this['error'](new _0x19397c('Request\x20timeout.',this['_context'])),_0x1a33ee);}get['promise'](){return this['_deferredPromise']['promise'];}['response'](_0x1d5795){this['_deferredPromise']['resolve'](_0x1d5795);}['error'](_0x3528fb){this['_deferredPromise']['reject'](_0x3528fb);}}export default class WebSocketGatewayRequestsManager{constructor(_0x3fc20f){this['_context']=_0x3fc20f,this['_requests']=new Set();}async['send'](_0x28d271,_0x5738db=0xafc8){const _0x2527d8=this['_createRequest'](_0x5738db);try{return _0x28d271(_0x2527d8),await _0x2527d8['promise'];}finally{this['_finishRequest'](_0x2527d8);}}['errorAll'](_0x573861){for(const _0x5a2698 of this['_requests'])_0x5a2698['error'](_0x573861);}['waitForAllRequests'](_0x1bd856=0xafc8){return this['_waitForRequests'](_0x1bd856);}['_createRequest'](_0x789464){const _0x5d89b0=new WebSocketRequest(this['_context'],_0x789464);return this['_requests']['add'](_0x5d89b0),_0x5d89b0;}['_finishRequest'](_0x30d953){this['_requests']['delete'](_0x30d953),clearTimeout(_0x30d953['timeout']);}async['_waitForRequests'](_0x5897dd=0x1388,_0x32d311=0x0){return!this['_requests']['size']||_0x32d311>=_0x5897dd/0x1f4?Promise['resolve']():(await new Promise(_0x4affc9=>{setTimeout(_0x4affc9,0x1f4);}),this['_waitForRequests'](_0x5897dd,_0x32d311++));}}